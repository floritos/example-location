{%- comment -%}
Include: detail_nav.html
Usage:
  {% include detail_nav.html list_url="/logements.html" list_label="Tous les logements" %}
Options:
  - list_url   : URL de la page liste (défaut: /logements.html)
  - list_label : libellé du bouton retour (défaut: "Tous les logements")
  - home_url   : URL accueil (défaut: /index.html)
  - home_label : libellé accueil (défaut: "Accueil")
{%- endcomment -%}

{%- assign list_url   = include.list_url   | default: "/logements.html" -%}
{%- assign list_label = include.list_label | default: "Tous les logements" -%}
{%- assign home_url   = include.home_url   | default: "/index.html" -%}
{%- assign home_label = include.home_label | default: "Accueil" -%}

<div class="detail-nav container my-3">

  <!-- Bouton retour (UX principal) -->
  <a class="btn btn-outline-secondary back-to-list"
     href="{{ list_url | relative_url }}">
    ← {{ list_label }}
  </a>

  <!-- Breadcrumb (contexte) -->
  <nav aria-label="Fil d’Ariane" class="mt-2">
    <ol class="breadcrumb mb-0">
      <li class="breadcrumb-item">
        <a href="{{ home_url | relative_url }}">{{ home_label }}</a>
      </li>
      <li class="breadcrumb-item">
        <a href="{{ list_url | relative_url }}">Logements</a>
      </li>
      <li class="breadcrumb-item active" aria-current="page">
        {{ page.title }}
      </li>
    </ol>
  </nav>

</div>

<script>
  (function () {
    // "Smart back": si on vient de la page logements, retour historique.
    // Sinon, on garde le href normal vers la liste.
    const btn = document.querySelector('.back-to-list');
    if (!btn) return;

    const listPath = new URL(btn.href, window.location.origin).pathname;

    if (document.referrer) {
      try {
        const ref = new URL(document.referrer);
        if (ref.origin === window.location.origin && ref.pathname === listPath) {
          btn.addEventListener('click', function (e) {
            e.preventDefault();
            history.back();
          });
        }
      } catch(e) { /* ignore */ }
    }
  })();
</script>
