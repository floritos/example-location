{%- comment -%}
Include: back_to_list.html

Usage simple :
  {% include back_to_list.html %}

Options :
  - url   : URL de la liste (défaut: /logements.html)
  - label : texte du bouton (défaut: "Tous les logements")
  - smart : true/false (défaut: true) -> utilise history.back() si on vient de la liste
{%- endcomment -%}

{%- assign url   = include.url   | default: "/logements.html" -%}
{%- assign label = include.label | default: "Tous les logements" -%}
{%- assign smart = include.smart | default: true -%}

<div class="container my-3">
  <a class="btn btn-outline-secondary back-to-list"
     href="{{ url | relative_url }}">
    ← {{ label }}
  </a>
</div>

{%- if smart -%}
<script>
  (function () {
    const btn = document.querySelector('.back-to-list');
    if (!btn) return;

    // Si l'utilisateur vient exactement de la page liste, on fait un retour "naturel"
    try {
      const listPath = new URL(btn.href, window.location.origin).pathname;
      const ref = document.referrer ? new URL(document.referrer) : null;

      if (ref && ref.origin === window.location.origin && ref.pathname === listPath) {
        btn.addEventListener('click', function (e) {
          e.preventDefault();
          history.back();
        });
      }
    } catch (e) { /* ignore */ }
  })();
</script>
{%- endif -%}
